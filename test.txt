this is modified by Brian.